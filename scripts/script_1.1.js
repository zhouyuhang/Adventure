/* variables */
var DIR_LEFT  = 0;
var DIR_RIGHT = 1;
var DIR_UP    = 2;
var DIR_DOWN  = 3;

/* load enchant.js */
enchant();

window.onload = function() {    
    var game = new Game(480, 320);
    game.fps = 25;
    game.preload('images/exmap0.png');//preload map
    game.preload('images/icon0.png');//preload icons
    game.preload('images/space3.png',
                'images/heroWalk/h1.png','images/heroWalk/h2.png','images/heroWalk/h3.png',
                'images/heroWalk/h4.png','images/heroWalk/h5.png','images/heroWalk/h6.png',
                'images/heroWalk/h7.png','images/heroWalk/h8.png','images/heroWalk/h9.png',
                'images/heroWalk/h10.png');//preload characters
    game.preload('images/NPCtile/village_inn.png','images/NPCtile/village_weapon.png',
                'images/NPCtile/village_item.png');//preload NPC tiles
    game.preload('sounds/effect/bubble.wav','sounds/effect/girl_laugh.wav');//preload musics and sounds effect
    

    game.onload = function() { 
        var map = new Map(16, 16);
        map.image = game.assets['images/exmap0.png'];
        map2(map);

        game.sound1 = game.assets['sounds/effect/bubble.wav'];
        game.sound2 = game.assets['sounds/effect/girl_laugh.wav'];

        //get user's info from database
        game.playerStat = function(){
          $.ajax({
              url : 'scripts/php/userstat.php',
              type : 'POST',
              dataType:'json',
              success : function(data) {
              game.playerImage(player,data);                
              }
          });
        };

        //set user's image
        game.playerImage = function(player,data){            
            player.image = game.assets['images/heroWalk/h'+ data[0].class +'.png'];            
        }


        //add user
        var player = new Sprite(32, 48);
        //player.image = game.assets['images/heroWalk/h1.png'];
        game.playerStat();
        
        player.x = 18 * 16 - 8;
        player.y = 15 * 16;        

        player.isMoving = false;
        player.direction = 0;
        player.walk = 1;
        player.addEventListener('enterframe', function() {
            this.frame = this.direction * 3 + this.walk;
            if (this.isMoving) {
                this.moveBy(this.vx, this.vy);
 
                if (true) {
                    this.walk++;
                    this.walk %= 3;
                }
                if ((this.vx && (this.x-8) % 16 == 0) || (this.vy && this.y % 16 == 0)) {
                    this.isMoving = false;
                    this.walk = 1;
                }
            } else {
                this.vx = this.vy = 0;
                if (game.input.left) {
                    this.direction = 1;
                    this.vx = -4;
                } else if (game.input.right) {
                    this.direction = 2;
                    this.vx = 4;
                } else if (game.input.up) {
                    this.direction = 3;
                    this.vy = -4;
                } else if (game.input.down) {
                    this.direction = 0;
                    this.vy = 4;
                }
                if (this.vx || this.vy) {
                    var x = this.x + (this.vx ? this.vx / Math.abs(this.vx) * 16 : 0) + 16;
                    var y = this.y + (this.vy ? this.vy / Math.abs(this.vy) * 16 : 0) + 32;
                    if (0 <= x && x < map.width && 0 <= y && y < map.height && !map.hitTest(x, y)) {
                        this.isMoving = true;
                        arguments.callee.call(this);
                    }
                }
            }
        });
        
        game.nameLabel = function(data){
            player.login_name = new Label(data[0].name);
            player.login_name.textAlign = 'center';
            player.login_name.width = 100;
            player.login_name.color = 'black';
            player.login_name.x = this.x - 35;
            player.login_name.y = this.y + 32;
            stage.addChild(player.login_name);
        }


        
        //sending current position to database
        game.updatePos = function(){
            xpos = player.x;
            ypos = player.y;
            //console.log(xpos+":"+ypos);
            $.ajax({
                url : 'scripts/php/updatePos.php',
                type : 'POST',
                data : {xposition:xpos,yposition:ypos},
                dataType:'json',
                success : function(data) {
                    console.log(data);
                }
            });
        }
        
        game.makeScene1 = function(){
            var scene = new Scene();
            scene.backgroundColor = "black";


            return scene;
        }

        game.addNPC = function(x,y){
            var Chara = new Sprite(32,32);
            Chara.image = game.assets['images/space3.png'];
            Chara.x = x;
            Chara.y = y;
            Chara.frame = [0,0,1,1,0,0,2,2];   
            Chara.addEventListener(Event.ENTER_FRAME, function() {
                if (Chara.scaleX === 1) {
                    Chara.x += 1;
                    if (Chara.x > x+50) Chara.scaleX = -1;
                } else {
                    Chara.x -= 1;
                    if (Chara.x < x) Chara.scaleX = 1;
                }
            });
            return Chara;
        }; 


        game.addNPC2 = function(pic,x,y){
            var Chara = new Sprite(32,48);
            Chara.image = game.assets['images/NPCtile/'+pic];
            Chara.x = x;
            Chara.y = y;
            Chara.frame = 0;   
            Chara.addEventListener(Event.ENTER_FRAME, function() {
            });
            return Chara;
        }; 

        game.playMusic = function(){
            var music = new Label();
            music.text = "Play Music";
            music.font = "12px Comic Sans, Comic Sans MS, cursive";
            music.color = "rgb(0,0,0)";
            music.x = 480-70;
            music.y = 3; 
            game.rootScene.addChild(music);
            music.addEventListener('touchend',function(){
                if(music.text == "Play Music"){
                    myAudio = new Audio('sounds/bgm_village.mp3');
                    myAudio.play();
                    music.text = "Stop Music";
                    myAudio.addEventListener('ended', function() {
                        this.currentTime = 0;
                        this.play();
                        }, false); 

                }else{
                    myAudio.pause();
                    music.text = "Play Music";
                }
            })
        };

        //Add Dialogue Message
        game.showMessage = function(text){
            var label = new Label(text);
            label.font = "14px Times, serif ";
            label.color = "rgb(255,255,255)";
            label.backgroundColor = "rgba(100,100,100,1)";
            label.x = 5;            
            label.y = 320-32;
            label.width = 470;
            label.height = 32;
            game.rootScene.addChild(label);

            label.addEventListener('enterframe',function(){
                if(label.age > text.length) game.rootScene.removeChild(label);
            });
        };

        //show greeting with user name on the top left corner
        function showName(result){
            $.ajax({
                    url : 'scripts/php/showSession.php',
                    type : 'POST',
                dataType:'json',
                success : function(data) {
                    //console.log("Welcome: "+ data);
                    game.rootScene.addChild(Greeting('Welcome: ' + data));                    
                }
            });
        }; 

        game.addOtherPlayers = function(data){
            var Others = new Sprite(32, 48);
            for(i=0;i<data.length;i++){
                Others.image = game.assets['images/heroWalk/h'+data[i].class+'.png'];
                Others.x = parseInt(data[i].xpos);
                Others.y = parseInt(data[i].ypos);
                Others.frame = [1,1,0,0,1,1,2,2];
                return Others;
            }
        };  

        //select all the other users from database who have logged in within the last 10 minutes
        //display the other users in map
        function displayOthers(result){
            $.ajax({
                    url : 'scripts/php/displayOthers.php',
                    type : 'POST',
                dataType:'json',
                success : function(data) {                    
                    for(i=0;i<data.length;i++){
                        //console.log(data[i]);                        
                        stage.addChild(game.addOtherPlayers(data));
                    }
                }
            })
        }; 

        var next = new Label("next scene");
        next.x = 300;
        next.addEventListener('touchstart',function(e){
            game.pushScene(game.makeScene1());
        });

        //add NPC bears
        ben = game.addNPC(300,250);

        alex = game.addNPC(120,170);
        alex.frame = [5,5,6,6,5,5,7,7];

        sani = game.addNPC(400,600);
        sani.frame = [10,10,11,11,10,10,12,12];

        henry = game.addNPC(50,700);
        henry.frame = [15,15,16,16,15,15,17,17];

        //add NPCs

        village_inn = game.addNPC2('village_inn.png',450,390);
        village_weapon = game.addNPC2('village_weapon.png',80,350);
        village_item = game.addNPC2('village_item.png',140,550);

        //add stage
        var stage = new Group();
        stage.addChild(map);        

        stage.addChild(ben);   
        stage.addChild(alex); 
        stage.addChild(sani); 
        stage.addChild(henry); 

        stage.addChild(village_inn);
        stage.addChild(village_weapon);
        stage.addChild(village_item);

        stage.addChild(player);

        
        game.addEventListener('load',function(){
            //displayOthers();  
            showName(); 
        });      

        game.rootScene.addChild(stage); 
        game.playMusic();
        //game.rootScene.addChild(next);        
        

        game.addEventListener('enterframe',function(){
            //game.updatePos();
                       
        }); 

        
        game.addEventListener('inputend',function(){
            if(player.intersect(ben)){
                game.showMessage('Ben: Welcome my friend, this is Bear Village. Talk to people to learn how tho play the game.'); 
                game.sound1.play();               
            }
            else if(player.intersect(alex)){
                game.showMessage('Alex: You can use (Arrow keys) to move your character.'); 
                game.sound1.play();               
            }
            else if(player.intersect(sani)){
                game.showMessage('Sani: fight the monsters outside the villages to protect us, and you will also get experience.'); 
                game.sound1.play();               
            }
            else if(player.intersect(henry)){
                game.showMessage('Henry: I have travelled a long way to find resource called honey in this planet.'); 
                game.sound1.play();               
            }
            else if(player.intersect(village_inn)){
                game.showMessage('InnKeeper: Do you want to have a rest for 10 gold pieces?'); 
                game.sound1.play();               
            }
            else if(player.intersect(village_weapon)){
                game.showMessage('Blacksmith: Welcome! We have a variety of excellent goods.'); 
                game.sound1.play();
            }
            else if(player.intersect(village_item)){
                game.showMessage('Shop Manager: Welcome to our shop. We have everything from daily necessities to medicine.'); 
                game.sound1.play(); 
            }
        });


        game.rootScene.addEventListener('enterframe', function(e) {
            var x = Math.min((game.width  - 16) / 2 - player.x, 0);
            var y = Math.min((game.height - 16) / 2 - player.y, 0);
            x = Math.max(game.width,  x + map.width)  - map.width;
            y = Math.max(game.height, y + map.height) - map.height;
            stage.x = x;
            stage.y = y;
        });

    };
        
    game.start();
};

/* all the other functions */


//random number
function rand(num){
        return Math.floor(Math.random() * num);
    }

//Backgrond Creation
function makeBackground(image){
    var bg = new Sprite(480,320);
    bg.image = image;
    return bg;
}

//greeting the current user
function Greeting(text){
    var label = new Label(text);
    label.font = "12px Comic Sans, Comic Sans MS, cursive";
    label.color = "rgb(0,0,0)";    
    label.backgroundColor = "rgba(0,255,255,0.5)";
    label.width = 100+text.length;
    label.height = 20;
    label.textAlign = "center";
    return label;
}


//Calculates the distance between two points
function calcLen(x0, y0, x1, y1) {
    return Math.sqrt((x0 - x1) * (x0 - x1) + (y0 - y1) * (y0 - y1));
}


function map2(backgroundMap){
backgroundMap.loadData([
    [39,39,40,107,107,107,107,107,107,107,107,107,107,11,57,107,242,243,243,244,107,55,56,56,10,107,394,38,39,39,39,39,39,39,39,39,39,39,39,39],
    [56,56,44,19,107,107,107,21,22,22,23,107,17,53,107,107,259,211,210,261,107,107,107,107,51,2,2,41,39,39,39,39,39,39,39,39,39,6,56,56],
    [362,401,343,37,107,107,17,45,56,56,44,2,53,107,107,107,107,242,244,107,107,107,107,107,107,107,107,55,56,56,56,56,7,39,39,39,6,57,107,107],
    [379,380,107,51,2,2,53,107,107,107,107,107,107,107,107,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,55,56,56,56,57,107,107,107],
    [396,397,107,107,361,401,343,107,107,107,107,107,107,107,107,107,107,242,208,226,226,226,226,226,227,107,107,107,107,107,107,107,107,107,107,107,107,107,225,226],
    [107,107,107,361,345,380,107,107,107,107,107,107,107,107,107,107,107,242,210,260,260,260,260,260,212,226,226,226,226,226,226,226,226,226,226,226,226,226,209,243],
    [107,107,107,378,346,397,107,107,107,107,107,107,107,107,107,107,107,242,244,107,107,107,107,107,259,260,260,260,260,260,260,260,260,260,260,260,260,260,211,243],
    [107,107,341,398,397,107,107,107,107,107,107,107,107,107,107,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,259,260],
    [107,360,107,394,107,107,107,107,107,107,107,107,107,107,107,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,360,107,107,107],
    [362,365,363,107,107,107,107,107,107,107,107,107,107,107,107,107,107,259,261,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,361,365,362,362,362],
    [379,346,397,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,378,379,346,396,347],
    [396,397,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,351,396,397,107,395],
    [107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,394,107,107,107,107],
    [107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,225,226,226,227,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107],
    [107,225,227,107,107,107,107,107,107,107,107,107,107,107,107,107,242,243,243,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,21,23,107],
    [107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,259,211,210,261,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,21,22,5,40,107],
    [107,242,244,124,124,124,124,124,124,124,124,124,124,124,75,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,38,39,39,40,107],
    [107,242,244,157,158,158,158,158,158,158,158,158,158,159,106,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,21,5,39,39,40,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,55,7,39,39,40,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,38,39,6,57,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,55,56,57,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,208,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,226,227,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,210,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,261,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,108,157,158,158,158,158,158,158,158,158,158,158,158,159,106,107,107,107,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,106,107,107,242,244,107,108,174,175,175,175,175,175,175,175,175,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,225,227,107,242,244,107,108,174,175,175,175,175,175,175,175,175,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,242,208,226,209,244,107,108,174,175,175,175,175,175,175,175,175,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,174,175,175,175,175,175,175,175,175,175,176,242,210,260,211,244,107,108,174,175,175,175,175,175,175,175,175,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,191,192,192,192,192,192,192,192,192,192,193,259,261,107,242,244,107,108,191,192,192,192,192,192,192,192,143,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,90,90,90,90,90,90,90,90,90,90,90,73,107,107,242,244,107,72,90,90,90,90,225,226,226,227,174,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,242,208,226,226,226,226,226,226,209,210,260,261,174,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,74,124,124,124,124,124,124,124,124,124,124,124,124,75,242,210,260,260,260,260,260,260,260,261,107,108,174,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,108,157,158,158,158,158,158,158,158,158,158,158,159,106,242,244,107,107,107,107,107,107,107,107,107,108,174,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,108,174,175,175,175,176,106,107,107,107,107,107],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,108,191,192,192,192,193,106,107,107,107,107,107],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,72,90,90,90,90,90,73,107,107,107,107,361],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,361,345],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,341,402,345,379],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,382,107,378,379,379],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,341,381,379,379],
    [107,242,244,108,174,175,175,175,175,175,175,175,175,175,175,176,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,382,107,107,378,379,379],
    [107,242,244,108,191,192,192,192,192,192,192,192,192,192,192,193,106,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,361,345,379,379],
    [107,242,244,72,90,90,90,90,225,226,226,227,90,90,90,90,73,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,395,347,379,379],
    [107,242,208,226,226,226,226,226,209,243,243,208,226,226,226,226,226,209,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,395,347,379],
    [107,259,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,211,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,382,107,395,396],
    [107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,242,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107],
    [107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,225,226,209,208,226,227,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107],
    [107,107,361,362,363,107,382,107,107,107,107,107,107,107,107,242,243,243,243,243,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107],
    [107,361,345,379,344,363,107,107,107,107,107,107,107,107,107,242,243,243,243,243,244,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107]
],[
    [-1,-1,-1,-1,386,-1,-1,-1,-1,-1,-1,-1,285,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,336,337,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,353,354,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [336,337,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [353,354,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [29,29,29,29,29,29,29,29,29,29,29,29,29,29,-1,335,-1,-1,-1,-1,335,-1,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],
    [-1,-1,-1,-1,386,386,-1,386,-1,336,337,-1,-1,-1,-1,352,-1,-1,-1,-1,352,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,336,337,-1,-1,285,-1,-1,-1],
    [-1,-1,-1,-1,-1,302,-1,386,-1,353,354,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,353,354,386,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,30,30,30,13,30,30,30,30,30,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,301,-1,301,13,-1,318,-1,318,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,303,-1,-1,13,-1,-1,-1,-1,-1,13,302,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,13,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,-1,386,-1],
    [-1,-1,-1,13,-1,-1,-1,13,-1,-1,-1,-1,-1,13,-1,302,-1,-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,302,-1,-1,386,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,13,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,13,-1,-1,-1,-1,-1,13,302,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,30,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,13,30,30,30,30,30,30,30,30,30,30,30,30,13,-1,-1,-1,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,30,-1,-1,-1,-1,-1,-1,-1,13,301,-1,-1,-1,-1,318,-1,-1,318,-1,-1,301,13,-1,336,337,-1,-1],
    [-1,-1,-1,13,46,46,46,46,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,353,354,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,302,-1,-1,-1],
    [-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1],
    [-1,-1,-1,30,30,30,30,30,30,30,30,30,30,30,-1,-1,-1,-1,-1,-1,-1,30,30,30,30,30,30,-1,-1,-1,-1,-1,-1,-1,13,302,-1,336,337,-1],
    [-1,-1,-1,-1,-1,-1,-1,371,371,-1,336,337,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,46,46,46,46,13,-1,-1,353,354,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,353,354,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,13,-1,302,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,13,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,30,30,30,30,30,30,30,30,30,30,13,-1,-1,243,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,13,302,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,284,284,13,-1,-1,243,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,284,284,-1,303,13,-1,-1,-1,-1,-1],
    [-1,-1,-1,302,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,243,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,30,30,30,30,30,30,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,286,13,302,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,286,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,46,46,46,46,46,46,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,336,337,-1,-1,-1,-1,-1],
    [-1,-1,-1,302,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,353,354,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,13,302,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,336,337,-1,-1,336,337,-1,-1,-1],
    [-1,-1,-1,-1,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,284,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,353,354,-1,-1,353,354,-1,-1,-1],
    [-1,-1,-1,-1,30,30,30,30,30,-1,-1,30,30,30,30,30,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,302,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [29,29,29,29,29,29,29,29,29,29,29,29,29,29,-1,371,-1,-1,-1,-1,371,-1,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],
    [-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]
]);
backgroundMap.collisionData = [
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],
    [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0],
    [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],
    [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1],
    [1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1],
    [1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [0,0,0,0,1,1,0,1,0,1,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,0],
    [0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0],
    [0,0,0,1,1,0,1,1,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,1,0,0,1,1,0,1,1,0,0],
    [0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0],
    [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,1,0,0,1,1,0],
    [0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,0],
    [0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1],
    [0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,1,1,1],
    [0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1,1],
    [0,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1],
    [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
    [1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
    [1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
];

};

